{"type":"javascript","options":{},"name":"DragDown to Refesh 下拉刷新","version":"1","tags":["工具脚本"],"synopsis":"手机浏览器，下拉刷新，测试中","source":"(function(window) {\n    var refreshText = document.createElement('p');\n    refreshText.id = \"refreshText\";\n    refreshText.style.cssText = \"position: absolute; width: 100%; line-height: 50px; text-align: center; left: 0; top: 0; font-size: 3em;\";\n    document.body.insertBefore(refreshText,document.body.firstChild);\n\n    const SENSITIVE = 300,//达到这个阈值才会刷新\n    TIPSHEIGHT = 150;  //这个是显示框宽度\n    var _element = document.body,\n        // _refreshText = document.querySelector('.refreshText'),\n        _refreshText = document.getElementById('refreshText'),\n        _startPos = 0,\n        _transitionHeight = 0,\n        _reloadFlag = 0;\n    _element.addEventListener('touchstart', function(e) {\n        // console.log('初始位置：', e.touches[0].pageY);\n        _startPos = e.touches[0].pageY;\n        _element.style.position = 'relative';\n        _element.style.transition = 'transform 0s';\n    }, false);\n\n    _element.addEventListener('touchmove', function(e) {\n        _transitionHeight = e.touches[0].pageY - _startPos;\n        if (_transitionHeight > 10) {\n            _element.style.transform = 'translateY('+Math.min(TIPSHEIGHT,_transitionHeight)+'px)';\n            if(_transitionHeight >= SENSITIVE){\n                _refreshText.style.color = \"yellowgreen\";\n            }\n            switch(Math.ceil(_transitionHeight/50)){\n                case 0:\n                _refreshText.innerText = ' ';\n                break;\n                case 1:\n                _refreshText.innerText = ' ';\n                break;\n                case 2:\n                _refreshText.innerText = ' ';\n                break;\n                case 3:\n                _refreshText.innerText = ' ';\n                break;\n                case 4:\n                _refreshText.innerText = ' ';\n                break;\n                case 5:\n                _refreshText.innerText = ' ';\n                break;\n            };\n        }\n    }, false);\n    _element.addEventListener('touchend', function(e) {\n        _element.style.transition = 'transform 0.1s ease 0.2s';\n        _element.style.transform = 'translateY(0px)';\n        if(_transitionHeight >= SENSITIVE){\n            location.reload();\n        }\n    }, false);\n})(window);","build":"(function () {\n    'use strict';\n\n    (function(window) {\n        var refreshText = document.createElement('p');\n        refreshText.id = \"refreshText\";\n        refreshText.style.cssText = \"position: absolute; width: 100%; line-height: 50px; text-align: center; left: 0; top: 0; font-size: 3em;\";\n        document.body.insertBefore(refreshText,document.body.firstChild);\n\n        const SENSITIVE = 300,\n        TIPSHEIGHT = 150;  \n        var _element = document.body,\n            \n            _refreshText = document.getElementById('refreshText'),\n            _startPos = 0,\n            _transitionHeight = 0;\n        _element.addEventListener('touchstart', function(e) {\n            \n            _startPos = e.touches[0].pageY;\n            _element.style.position = 'relative';\n            _element.style.transition = 'transform 0s';\n        }, false);\n\n        _element.addEventListener('touchmove', function(e) {\n            _transitionHeight = e.touches[0].pageY - _startPos;\n            if (_transitionHeight > 10) {\n                _element.style.transform = 'translateY('+Math.min(TIPSHEIGHT,_transitionHeight)+'px)';\n                if(_transitionHeight >= SENSITIVE){\n                    _refreshText.style.color = \"yellowgreen\";\n                }\n                switch(Math.ceil(_transitionHeight/50)){\n                    case 0:\n                    _refreshText.innerText = ' ';\n                    break;\n                    case 1:\n                    _refreshText.innerText = ' ';\n                    break;\n                    case 2:\n                    _refreshText.innerText = ' ';\n                    break;\n                    case 3:\n                    _refreshText.innerText = ' ';\n                    break;\n                    case 4:\n                    _refreshText.innerText = ' ';\n                    break;\n                    case 5:\n                    _refreshText.innerText = ' ';\n                    break;\n                }        }\n        }, false);\n        _element.addEventListener('touchend', function(e) {\n            _element.style.transition = 'transform 0.1s ease 0.2s';\n            _element.style.transform = 'translateY(0px)';\n            if(_transitionHeight >= SENSITIVE){\n                location.reload();\n            }\n        }, false);\n    })();\n\n})();\n","detail":""}
